name: M3U8_Creator

on:
  workflow_dispatch:
  # Run every 2 hours after https://github.com/bitsbb01/iptvcat-scrapper
  # 12.10 UTC Time, 06.10 Central Time
  # Changed to every 2 hours, due to including Youtube links and Pluto, so those links are always correct and the playlist is always upto date.
  schedule:
    - cron: "0 0/2 * * *"

jobs:

  Running_M3U8_Creator:
    name: Running M3U8 Creator
    runs-on: "ubuntu-latest"

    steps:
      - uses: actions/checkout@v2

      - name: Last Attempts
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          echo $(date) >> last_attempt.txt
          cat last_attempt.txt
          ls -ltr
          git status
          git add last_attempt.txt
          git status
          git commit -m "cron: setting last attempt time stamp" -a
          git status
          
      - name: Checkout code
        uses: actions/checkout@v1

      - name: Check *.M3u8 File existence
        id: check_files
        uses: andstor/file-existence-action@v1
        with:
          files: "./CompiledallStreams.m3u, ./epg/epg_ripper_ALL_SOURCES1.xml.gz"

      - uses: actions/checkout@v2
      - name: If *.M3U8 Files exists - Then Cleanup
        if: steps.check_files.outputs.files_exists == 'true'
        # Only runs if all of the files exists
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git rm ./tests/m3u8/*.m3u8
          git rm ./m3u8/*.m3u8
          git rm ./*.m3u8
          git rm ./tests/epg/*.gz
          git rm ./epg/*.gz
          git rm ./temp/m3u8_static/*.m3u8
          git rm ./temp/m3u8_static/all/*.m3u8
          git rm ./temp/all_streams_tmp/*.json
          git status
          git push          
          git commit -m "cron: Updated by Bot" -a
         
        
      ### SETUP THE ENVIRONMENT
      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Setup Environment
        # e.g. create work dirst, store in env variables ... https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-commands-for-github-actions
        run: |
          echo "IPTVCAT_DATE=$(date '+%Y-%m-%d')" >> $GITHUB_ENV
          echo "IPTVCAT_DATE_YESTERDAY=$(date -d "yesterday 7:00" '+%Y-%m-%d')" >> $GITHUB_ENV
          echo "IPTVCAT_DOWNLOAD_DIR=./temp/iptvcat" >> $GITHUB_ENV
          echo "M3U8_DIR=./tests/m3u8/" >> $GITHUB_ENV
          echo "EPG_TEMP_DIR=./tests/epg/" >> $GITHUB_ENV
          echo "M3U8_STATIC_DIR=./temp/m3u8_static/" >> $GITHUB_ENV
          echo "M3U8_STATIC_DIR2=./temp/m3u8_static/all/" >> $GITHUB_ENV
          # Update pythonpath used for our scripts
          echo "PYTHONPATH=$PYTHONPATH:${{ github.workspace }}" >> $GITHUB_ENV
      - name: Setup Dirs
        run: |
          echo "IPTVCAT_DATE: '${IPTVCAT_DATE}'"
          echo "IPTVCAT_DATE_YESTERDAY: '${IPTVCAT_DATE_YESTERDAY}'"
          echo "IPTVCAT_DOWNLOAD_DIR: '${IPTVCAT_DOWNLOAD_DIR}'"
          echo "M3U8_DIR: '${M3U8_DIR}'"
          echo "EPG_TEMP_DIR: '${EPG_TEMP_DIR}'"
          echo "M3U8_STATIC_DIR: '${M3U8_STATIC_DIR}'"
          echo "Command: 'mkdir -p ${IPTVCAT_DOWNLOAD_DIR}'"
          mkdir -p ${IPTVCAT_DOWNLOAD_DIR}
          echo "Command: 'mkdir -p ${M3U8_DIR}'"
          mkdir -p ${M3U8_DIR}
          echo "Command: 'mkdir -p ${EPG_TEMP_DIR}'"
          mkdir -p ${EPG_TEMP_DIR}
          echo "Command: 'mkdir -p ${M3U8_STATIC_DIR2}'"
          mkdir -p ${M3U8_STATIC_DIR2}
          echo "Command: 'mkdir -p ${M3U8_STATIC_DIR}'"
          mkdir -p ${M3U8_STATIC_DIR}
          echo "Command: 'ls -alt ${IPTVCAT_DOWNLOAD_DIR}'"
          ls -alt ${IPTVCAT_DOWNLOAD_DIR}
          echo "Command: 'ls -alt ${M3U8_DIR}'"
          ls -alt ${M3U8_DIR}
          echo "Command: 'ls -alt ${EPG_TEMP_DIR}'"
          ls -alt ${EPG_TEMP_DIR}
          echo "Command: 'ls -alt ${M3U8_STATIC_DIR}'"
          ls -alt ${M3U8_STATIC_DIR}
          echo "Command: 'ls -alt ${M3U8_STATIC_DIR2}'"
          ls -alt ${M3U8_STATIC_DIR2}
      - name: Get other m3u8s to add
        run: |

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/squidtv.m3u8" "${M3U8_STATIC_DIR}" "squidtv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/squidtv.m3u8" "${M3U8_STATIC_DIR}" "squidtv.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/Christmas%20365.m3u" "${M3U8_STATIC_DIR}" "christmas365.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/Christmas%20365.m3u" "${M3U8_STATIC_DIR}" "christmas365.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "hhttps://raw.githubusercontent.com/bitsbb01/storage/main/cxtvlive.m3u8" "${M3U8_STATIC_DIR}" "cxtvlive.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/cxtvlive.m3u8" "${M3U8_STATIC_DIR}" "cxtvlive.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/IPTVM3U/master/Dash%20Radio.m3u" "${M3U8_STATIC_DIR}" "dashradio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/IPTVM3U/master/Dash%20Radio.m3u" "${M3U8_STATIC_DIR}" "dashradio.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/30atv.m3u8" "${M3U8_STATIC_DIR}" "30atv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/30atv.m3u8" "${M3U8_STATIC_DIR}" "30atv.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/freetuxtv.m3u" "${M3U8_STATIC_DIR}" "freetuxtv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/freetuxtv.m3u" "${M3U8_STATIC_DIR}" "freetuxtv.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/fslsports.m3u8" "${M3U8_STATIC_DIR}" "fslsports.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/fslsports.m3u8" "${M3U8_STATIC_DIR}" "fslsports.m3u8"
        
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/vodnew1.m3u" "${M3U8_STATIC_DIR}" "vodnew1.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/vodnew1.m3u" "${M3U8_STATIC_DIR}" "vodnew1.m3u8"
        
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Combined/master/combined.m3u" "${M3U8_STATIC_DIR}" "DeltaSr95combined.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Combined/master/combined.m3u" "${M3U8_STATIC_DIR}" "DeltaSr95combined.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/junguler/m3u-radio-music-playlists/main/---everything-full.m3u" "${M3U8_STATIC_DIR}" "jungulermusic.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/junguler/m3u-radio-music-playlists/main/---everything-full.m3u" "${M3U8_STATIC_DIR}" "jungulermusic.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/radio.m3u" "${M3U8_STATIC_DIR}" "bbradio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/radio.m3u" "${M3U8_STATIC_DIR}" "bbradio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/0nradio.com.m3u" "${M3U8_STATIC_DIR}" "0nradio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/0nradio.com.m3u" "${M3U8_STATIC_DIR}" "0nradio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/181.fm.m3u" "${M3U8_STATIC_DIR}" "181.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/181.fm.m3u" "${M3U8_STATIC_DIR}" "181.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/BigRRadio.m3u" "${M3U8_STATIC_DIR}" "BigRRadio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/BigRRadio.m3u" "${M3U8_STATIC_DIR}" "BigRRadio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/Dash%20Radio.m3u" "${M3U8_STATIC_DIR}" "DashRadio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/Dash%20Radio.m3u" "${M3U8_STATIC_DIR}" "DashRadio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/France.Radio.m3u" "${M3U8_STATIC_DIR}" "FranceRadio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/France.Radio.m3u" "${M3U8_STATIC_DIR}" "FranceRadio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/GotRadio.m3u" "${M3U8_STATIC_DIR}" "GotRadio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/GotRadio.m3u" "${M3U8_STATIC_DIR}" "GotRadio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/MCR%20Radios.m3u" "${M3U8_STATIC_DIR}" "mcrradio.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/MCR%20Radios.m3u" "${M3U8_STATIC_DIR}" "mcrradio.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/PromoDJ.m3u" "${M3U8_STATIC_DIR}" "PromoDJ.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/PromoDJ.m3u" "${M3U8_STATIC_DIR}" "PromoDJ.m3u8"
             
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/Weareone.fm.m3u" "${M3U8_STATIC_DIR}" "Weareone.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Radio/Weareone.fm.m3u" "${M3U8_STATIC_DIR}" "Weareone.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://directory.owncast.online/api/iptv" "${M3U8_STATIC_DIR}" "owncast.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://directory.owncast.online/api/iptv" "${M3U8_STATIC_DIR}" "owncast.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/TV2/master/TV21.m3u" "${M3U8_STATIC_DIR}" "cablevision.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/TV2/master/TV21.m3u" "${M3U8_STATIC_DIR}" "cablevision.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/PREMIUMHD/main/TV21.m3u" "${M3U8_STATIC_DIR}" "premiumhd.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/PREMIUMHD/main/TV21.m3u" "${M3U8_STATIC_DIR}" "premiumhd.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/TV/master/TV21.m3u" "${M3U8_STATIC_DIR}" "skydish.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/TV/master/TV21.m3u" "${M3U8_STATIC_DIR}" "skydish.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/SeriesHD/master/tv21.m3u" "${M3U8_STATIC_DIR}" "serieshd.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/TVPRO20/SeriesHD/master/tv21.m3u" "${M3U8_STATIC_DIR}" "serieshd.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/OFCVIPMovies2.m3u" "${M3U8_STATIC_DIR}" "vod2.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/OFCVIPMovies2.m3u" "${M3U8_STATIC_DIR}" "vod2.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/OFCVIPMovies.m3u" "${M3U8_STATIC_DIR}" "vod1.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/OFCVIPMovies.m3u" "${M3U8_STATIC_DIR}" "vod1.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/new/__%20VIP%20MOVIES%20__.m3u" "${M3U8_STATIC_DIR}" "vod3.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/IPTV-M3US/master/m3us/new/__%20VIP%20MOVIES%20__.m3u" "${M3U8_STATIC_DIR}" "vod3.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/ustvgotom3u/main/ustvgo.m3u" "${M3U8_STATIC_DIR}" "ustvgo.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/ustvgotom3u/main/ustvgo.m3u" "${M3U8_STATIC_DIR}" "ustvgo.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/RoStreamTV/RoStreamTV.github.io/main/RoStreamTV_ONLINE.m3u" "${M3U8_STATIC_DIR}" "RoStreamTV_ONLINE.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/RoStreamTV/RoStreamTV.github.io/main/RoStreamTV_ONLINE.m3u" "${M3U8_STATIC_DIR}" "RoStreamTV_ONLINE.m3u8"

          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Music/main/fmstreamorg_usa.m3u" "${M3U8_STATIC_DIR}" "fmstreamorg_usa.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Music/main/fmstreamorg_usa.m3u" "${M3U8_STATIC_DIR}" "fmstreamorg_usa.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Music/main/live365.m3u" "${M3U8_STATIC_DIR}" "live365.m3u8"'"

          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/DeltaSr95/Music/main/live365.m3u" "${M3U8_STATIC_DIR}" "live365.m3u8"
         
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/cctv.m3u8" "${M3U8_STATIC_DIR}" "cctv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/cctv.m3u8" "${M3U8_STATIC_DIR}" "cctv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/PBS/all.m3u8" "${M3U8_STATIC_DIR}" "pbsall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/PBS/all.m3u8" "${M3U8_STATIC_DIR}" "pbsall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/Plex/all.m3u8" "${M3U8_STATIC_DIR}" "plexall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/Plex/all.m3u8" "${M3U8_STATIC_DIR}" "plexall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/PlutoTV/all.m3u8" "${M3U8_STATIC_DIR}" "plutoall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/PlutoTV/all.m3u8" "${M3U8_STATIC_DIR}" "plutoall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/SamsungTVPlus/all.m3u8" "${M3U8_STATIC_DIR}" "SamsungTVPlusall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/SamsungTVPlus/all.m3u8" "${M3U8_STATIC_DIR}" "SamsungTVPlusall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/Stirr/all.m3u8" "${M3U8_STATIC_DIR}" "stirrall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/matthuisman/i.mjh.nz/master/Stirr/all.m3u8" "${M3U8_STATIC_DIR}" "stirrall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://www.apsattv.com/rok.m3u" "${M3U8_STATIC_DIR}" "rok.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://www.apsattv.com/rok.m3u" "${M3U8_STATIC_DIR}" "rok.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AVO.TV/AVO.TV.m3u" "${M3U8_STATIC_DIR}" "avotv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AVO.TV/AVO.TV.m3u" "${M3U8_STATIC_DIR}" "avotv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AdultSwim/AdultSwim.m3u" "${M3U8_STATIC_DIR}" "AdultSwim.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AdultSwim/AdultSwim.m3u" "${M3U8_STATIC_DIR}" "AdultSwim.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AnthymTV/AnthymTV.m3u" "${M3U8_STATIC_DIR}" "AnthymTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/AnthymTV/AnthymTV.m3u" "${M3U8_STATIC_DIR}" "AnthymTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/CanelaTV/Canela.TV.m3u" "${M3U8_STATIC_DIR}" "CanelaTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/CanelaTV/Canela.TV.m3u" "${M3U8_STATIC_DIR}" "CanelaTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/DistroTV/DistroTV.m3u" "${M3U8_STATIC_DIR}" "DistroTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/DistroTV/DistroTV.m3u" "${M3U8_STATIC_DIR}" "DistroTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Freeli.tv/Freeli.tv.m3u" "${M3U8_STATIC_DIR}" "Freeli.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Freeli.tv/Freeli.tv.m3u" "${M3U8_STATIC_DIR}" "Freeli.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/GlewedTV/Glewed.TV.m3u" "${M3U8_STATIC_DIR}" "Glewed.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/GlewedTV/Glewed.TV.m3u" "${M3U8_STATIC_DIR}" "Glewed.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Good%20TV/GoodTV.m3u" "${M3U8_STATIC_DIR}" "GoodTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Good%20TV/GoodTV.m3u" "${M3U8_STATIC_DIR}" "GoodTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/HerogoTV/HerogoTV.m3u" "${M3U8_STATIC_DIR}" "HerogoTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/HerogoTV/HerogoTV.m3u" "${M3U8_STATIC_DIR}" "HerogoTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Jungo%2BTV/Jungo%2BTV.m3u" "${M3U8_STATIC_DIR}" "Jungo.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Jungo%2BTV/Jungo%2BTV.m3u" "${M3U8_STATIC_DIR}" "Jungo.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/LocalNow/LocalNow.m3u" "${M3U8_STATIC_DIR}" "LocalNow.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/LocalNow/LocalNow.m3u" "${M3U8_STATIC_DIR}" "LocalNow.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Muzzik.tv/Muzzik.tv.m3u" "${M3U8_STATIC_DIR}" "Muzzik.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Muzzik.tv/Muzzik.tv.m3u" "${M3U8_STATIC_DIR}" "Muzzik.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/MyTvToGo/MyTvToGo.m3u" "${M3U8_STATIC_DIR}" "MyTvToGo.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/MyTvToGo/MyTvToGo.m3u" "${M3U8_STATIC_DIR}" "MyTvToGo.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Rad.TV/Rad.TV.m3u" "${M3U8_STATIC_DIR}" "Rad.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Rad.TV/Rad.TV.m3u" "${M3U8_STATIC_DIR}" "Rad.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/RakutenTV/RakutenTV.m3u" "${M3U8_STATIC_DIR}" "RakutenTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/RakutenTV/RakutenTV.m3u" "${M3U8_STATIC_DIR}" "RakutenTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/RedBoxTV/RedBoxTV.m3u" "${M3U8_STATIC_DIR}" "RedBoxTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/RedBoxTV/RedBoxTV.m3u" "${M3U8_STATIC_DIR}" "RedBoxTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Sluhay.by/Sluhay.by.m3u" "${M3U8_STATIC_DIR}" "Sluhay.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Sluhay.by/Sluhay.by.m3u" "${M3U8_STATIC_DIR}" "Sluhay.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Smash/smash_plus.m3u" "${M3U8_STATIC_DIR}" "Smash.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/Smash/smash_plus.m3u" "${M3U8_STATIC_DIR}" "Smash.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/TV25/TV25.m3u" "${M3U8_STATIC_DIR}" "TV25.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/TV25/TV25.m3u" "${M3U8_STATIC_DIR}" "TV25.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/TeleVall/TeleVall.m3u" "${M3U8_STATIC_DIR}" "TeleVall.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/TeleVall/TeleVall.m3u" "${M3U8_STATIC_DIR}" "TeleVall.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/tubi.m3u" "${M3U8_STATIC_DIR}" "TubiTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/tubi.m3u" "${M3U8_STATIC_DIR}" "TubiTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/VisionTV/VisionTV.m3u" "${M3U8_STATIC_DIR}" "VisionTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/VisionTV/VisionTV.m3u" "${M3U8_STATIC_DIR}" "VisionTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://cutt.ly/Galxytv" "${M3U8_STATIC_DIR}" "Galxytv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://cutt.ly/Galxytv" "${M3U8_STATIC_DIR}" "Galxytv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://www.apsattv.com/lg.m3u" "${M3U8_STATIC_DIR}" "lgtv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://www.apsattv.com/lg.m3u" "${M3U8_STATIC_DIR}" "lgtv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://www.apsattv.com/klowd.m3u" "${M3U8_STATIC_DIR}" "klowd2.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://www.apsattv.com/klowd.m3u" "${M3U8_STATIC_DIR}" "klowd2.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/VizioTV/VizioTV.m3u" "${M3U8_STATIC_DIR}" "VizioTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/VizioTV/VizioTV.m3u" "${M3U8_STATIC_DIR}" "VizioTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/WatchYourTV/WatchYourTV.m3u" "${M3U8_STATIC_DIR}" "WatchYourTV.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/WatchYourTV/WatchYourTV.m3u" "${M3U8_STATIC_DIR}" "WatchYourTV.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/allsprk.tv/allsprk.tv.m3u" "${M3U8_STATIC_DIR}" "allsprk.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/allsprk.tv/allsprk.tv.m3u" "${M3U8_STATIC_DIR}" "allsprk.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/bumblebee.tv/bumblebee.tv.m3u" "${M3U8_STATIC_DIR}" "bumblebee.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/bumblebee.tv/bumblebee.tv.m3u" "${M3U8_STATIC_DIR}" "bumblebee.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/flixhub/flixhub.m3u" "${M3U8_STATIC_DIR}" "flixhub.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/flixhub/flixhub.m3u" "${M3U8_STATIC_DIR}" "flixhub.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/vaughn.Live/vaughn.Live.m3u" "${M3U8_STATIC_DIR}" "vaughn.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/vaughn.Live/vaughn.Live.m3u" "${M3U8_STATIC_DIR}" "vaughn.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/veely.tv/veely.tv.m3u" "${M3U8_STATIC_DIR}" "veely.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Streaming%20Service%20Network/veely.tv/veely.tv.m3u" "${M3U8_STATIC_DIR}" "veely.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Xumo.VOD.m3u" "${M3U8_STATIC_DIR}" "xumovod.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/Xumo.VOD.m3u" "${M3U8_STATIC_DIR}" "xumovod.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/music.m3u" "${M3U8_STATIC_DIR}" "Sphinxrootmusic.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/Sphinxroot/iptvmu3/main/music.m3u" "${M3U8_STATIC_DIR}" "Sphinxrootmusic.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/new.m3u" "${M3U8_STATIC_DIR}" "moreiptv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_xumo.m3u" "${M3U8_STATIC_DIR}" "us_xumo.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_xumo.m3u" "${M3U8_STATIC_DIR}" "us_xumo.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_imdbtv.m3u" "${M3U8_STATIC_DIR}" "us_imdbtv.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_imdbtv.m3u" "${M3U8_STATIC_DIR}" "us_imdbtv.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_fubo.m3u" "${M3U8_STATIC_DIR}" "us_fubo.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_fubo.m3u" "${M3U8_STATIC_DIR}" "us_fubo.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_wfmz.m3u" "${M3U8_STATIC_DIR}" "us_wfmz.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_wfmz.m3u" "${M3U8_STATIC_DIR}" "us_wfmz.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/uk_sportstribal.m3u" "${M3U8_STATIC_DIR}" "uk_sportstribal.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/uk_sportstribal.m3u" "${M3U8_STATIC_DIR}" "uk_sportstribal.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_redbox.m3u" "${M3U8_STATIC_DIR}" "us_redbox.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/iptv-org/iptv/master/streams/us_redbox.m3u" "${M3U8_STATIC_DIR}" "us_redbox.m3u8"
          
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/twitch.m3u" "${M3U8_STATIC_DIR}" "twitch.m3u8"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/storage/main/twitch.m3u" "${M3U8_STATIC_DIR}" "twitch.m3u8"
         
      - name: Match EPG IDs to Static Files
        run: |
          echo "Command: './scripts/match_epgid_to_names.sh "${M3U8_STATIC_DIR}" "${M3U8_STATIC_DIR}"'"
          ./scripts/match_epgid_to_names.sh "${M3U8_STATIC_DIR}" "${M3U8_STATIC_DIR}"          
          
          ls -alt "${M3U8_STATIC_DIR}"        
 
      - name: Merge Files
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          cat ./temp/m3u8_static/*.m3u8 > ./temp/m3u8_static/all/all-staticstreams.m3u8       
          
          ls -alt "${M3U8_STATIC_DIR2}" 
          
      - name: Merge Static All_Streams Files
        run: |
          ls -alt ./temp/m3u8_static/
          ls -alt ./temp/m3u8_static/all/
          echo "Command: './scripts/merge_m3u8_files_in_dirs.sh "./temp/m3u8_static/" "./temp/m3u8_static/all/"'"
          ./scripts/merge_m3u8_files_in_dirs.sh "./temp/m3u8_static/" "./temp/m3u8_static/all/"
          ls -alt ./temp/m3u8_static/
          ls -alt ./temp/m3u8_static/all/ 
          
          
      - name: Get epg
        run: |
         
          echo "Command: './scripts/download_file_allow_failiure.sh "https://github.com/epgshare01/share01/raw/master/epg_ripper_ALL_SOURCES1.xml.gz" "./tests/epg/" "epg_ripper_ALL_SOURCES1.xml.gz"'"
          ./scripts/download_file_allow_failiure.sh "https://github.com/epgshare01/share01/raw/master/epg_ripper_ALL_SOURCES1.xml.gz" "./tests/epg/" "epg_ripper_ALL_SOURCES1.xml.gz"
   
   
      - name: Get EPG from epgshare
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://github.com/epgshare01/share01/raw/master/" "${EPG_TEMP_DIR}" "epg_ripper_ALL_SOURCES1.xml.gz"'"
          ./scripts/download_file_allow_failiure.sh "https://github.com/epgshare01/share01/raw/master/" "${EPG_TEMP_DIR}" "epg_ripper_ALL_SOURCES1.xml.gz"
          
          ls -alt "${EPG_TEMP_DIR}" 
          
          
      - name: Get the main streams json
        run: |        
          echo "Command: './scripts/download_file_allow_failiure.sh "https://github.com/bitsbb01/ez-iptvcat-scraper/blob/master/data/all-streams.json?raw=true" "./temp/all_streams_tmp/" "all-streams.json"'"
          ./scripts/download_file_allow_failiure.sh "https://github.com/bitsbb01/ez-iptvcat-scraper/blob/master/data/all-streams.json?raw=true" "./temp/all_streams_tmp/" "all-streams.json"
          
          
      - name: Get Europe streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest2/master/data/countries/europe.json" "./temp/all_streams_tmp/" "all-europe.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest2/master/data/countries/europe.json" "./temp/all_streams_tmp/" "all-europe.json"

      - name: Get the Africa streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/africa.json" "./temp/all_streams_tmp/" "all-africa.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/africa.json" "./temp/all_streams_tmp/" "all-africa.json"
          
 
      - name: Get the Asia streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/asia.json" "./temp/all_streams_tmp/" "all-asia.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/asia.json" "./temp/all_streams_tmp/" "all-asia.json"
          
 
      - name: Get the Latin America streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/latin%20america.json" "./temp/all_streams_tmp/" "all-latinamerica.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/latin%20america.json" "./temp/all_streams_tmp/" "all-latinamerica.json"
         
 
      - name: Get the Arab streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/arab%20countries.json" "./temp/all_streams_tmp/" "all-arab%20countries.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper-rest1/master/data/countries/arab%20countries.json" "./temp/all_streams_tmp/" "all-arab%20countries.json"
          
          
      - name: Get the UK streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/cat-scrapperuk/master/data/countries/united%20kingdom.json" "./temp/all_streams_tmp/" "uk-streams.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/cat-scrapperuk/master/data/countries/united%20kingdom.json" "./temp/all_streams_tmp/" "uk-streams.json"
          
      - name: Get the North America streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/cat-scrapperus/master/data/countries/united%20states%20of%20america.json" "./temp/all_streams_tmp/" "catusa.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/cat-scrapperus/master/data/countries/united%20states%20of%20america.json" "./temp/all_streams_tmp/" "catusa.json"
          
      - name: Get the Underfined Streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapperundefined/master/data/countries/undefined.json" "./temp/all_streams_tmp/" "catundefined.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapperundefined/master/data/countries/undefined.json" "./temp/all_streams_tmp/" "catundefined.json"
          
      - name: Get the Canada Streams json
        run: |
          echo "Command: './scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper_canada/master/data/countries/canada.json" "./temp/all_streams_tmp/" "canada.json"'"
          ./scripts/download_file_allow_failiure.sh "https://raw.githubusercontent.com/bitsbb01/catscrapper_canada/master/data/countries/canada.json" "./temp/all_streams_tmp/" "canada.json"
          
    
      ### PROCESS THE DATA ###
      - name: Convert all_streams
        run: |
          echo "Command: 'ls -alt ./temp/all_streams_tmp/'"
          ls -alt ./temp/all_streams_tmp/
          echo "Command: 'ls -alt ${M3U8_DIR}'"
          ls -alt ${M3U8_DIR}
          echo "Command: 'python ./scripts/iptvcat/convert_iptvcat_scraper_files.py "./temp/all_streams_tmp/" "${M3U8_DIR}"'"
          python ./scripts/iptvcat/convert_iptvcat_scraper_files.py "./temp/all_streams_tmp/" "${M3U8_DIR}"
          echo "Command: 'ls -alt ./temp/all_streams_tmp/'"
          ls -alt ./temp/all_streams_tmp/
          echo "Command: 'ls -alt ${M3U8_DIR}'"
          ls -alt ${M3U8_DIR}
          
      - name: Merge with Static All_Streams Files
        run: |
          ls -alt ./tests/m3u8/
          ls -alt ${M3U8_STATIC_DIR}
          echo "Command: './scripts/merge_m3u8_files_in_dirs.sh "./tests/m3u8/" "${M3U8_STATIC_DIR}"'"
          ./scripts/merge_m3u8_files_in_dirs.sh "./tests/m3u8/" "${M3U8_STATIC_DIR}"
          ls -alt ./tests/m3u8/
          ls -alt ${M3U8_STATIC_DIR}
                    
      - name: Add EPG URL to files
        run: |
          echo "Command: 'python ./scripts/add_epg_url_into_m3u8.py --epg_url "https://github.com/bitsbb01/m3u8_creator/raw/main/epg/epg_ripper_ALL_SOURCES1.xml.gz,https://raw.githubusercontent.com/Theitfixer85/myepg/master/blueepg.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/DeltaSr95/Combined/raw/master/combined.xml.gz,https://github.com/DeltaSr95/Music/raw/main/fmstreamorg_usa.xml,https://github.com/DeltaSr95/Music/raw/main/live365.xml,https://github.com/botallen/epg/releases/download/latest/epg.xml,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PBS/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/Plex/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/SamsungTVPlus/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/Stirr/all.xml.gz,https://cutt.ly/Galxytvepg" --m3u8_in_dir "${M3U8_DIR}" --m3u8_out_dir "${M3U8_DIR}"'"
          python ./scripts/add_epg_url_into_m3u8.py --epg_url "https://github.com/bitsbb01/m3u8_creator/raw/main/epg/epg_ripper_ALL_SOURCES1.xml.gz,https://raw.githubusercontent.com/Theitfixer85/myepg/master/blueepg.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/DeltaSr95/Combined/raw/master/combined.xml.gz,https://github.com/DeltaSr95/Music/raw/main/fmstreamorg_usa.xml,https://github.com/DeltaSr95/Music/raw/main/live365.xml,https://github.com/botallen/epg/releases/download/latest/epg.xml,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PBS/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/Plex/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/PlutoTV/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/SamsungTVPlus/all.xml.gz,https://github.com/matthuisman/i.mjh.nz/raw/master/Stirr/all.xml.gz,https://cutt.ly/Galxytvepg" --m3u8_in_dir "${M3U8_DIR}" --m3u8_out_dir "${M3U8_DIR}"

      - name: Add Channel To Main Categories
        run: |
          echo "Command: 'python ./scripts/import_categories_into_m3u8.py --category_file "./ez_m3u8_creator/categories/main.json" --m3u8_in_dir "${M3U8_DIR}" --m3u8_out_dir "${M3U8_DIR}"'"
          python ./scripts/import_categories_into_m3u8.py --category_file "./ez_m3u8_creator/categories/main.json" --m3u8_in_dir "${M3U8_DIR}" --m3u8_out_dir "${M3U8_DIR}"
 
      - name: Match EPG IDs
        run: |
          echo "Command: './scripts/match_epgid_to_names.sh "${M3U8_DIR}" "${M3U8_DIR}"'"
          ./scripts/match_epgid_to_names.sh "${M3U8_DIR}" "${M3U8_DIR}"
          echo "Command: './scripts/match_epgid_to_names.sh "${M3U8_STATIC_DIR2}" "${M3U8_STATIC_DIR2}"'"
          ./scripts/match_epgid_to_names.sh "${M3U8_STATIC_DIR2}" "${M3U8_STATIC_DIR2}"
                     
      - name: Push all changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.scrapper_token }}
          branch: ${{ github.ref }} 
             
      - name: Copy Static m3u8s
        uses: canastro/copy-file-action@master
        with:
          source: "./temp/m3u8_static/*.m3u8"
          target: "./m3u8"
          flags: '-r'
             
      - name: Copy Static m3u8s all_file
        uses: canastro/copy-file-action@master
        with:
          source: "./temp/m3u8_static/all/*.m3u8"
          target: "./m3u8"
          flags: '-r'
          
      ### This is where the copy function should work, to copy the m3u8 & epg to the data folder ###
      - name: Copy m3u8
        uses: canastro/copy-file-action@master
        with:
          source: "./tests/m3u8/*.m3u8"
          target: "./m3u8"
          flags: '-r'
          
          
      - name: Copy epg
        uses: canastro/copy-file-action@master
        with:
          source: "./tests/epg/*"
          target: "./epg"
          flags: '-r'
    
          
      - name: Copy json
        uses: canastro/copy-file-action@master
        with:
          source: "./temp/iptvcat*"
          target: "./json"
          flags: '-r'
                  
          
      - name: Get current date
        id: date
        run: echo "::set-output name=date::$(date '+%Y-%m-%d')"


      - name: Merge All The Files Into Compiled-all-UpdatedStreams.m3u
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          ls -1 ./m3u8/*.m3u8 > ./allstreams.txt
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./Compiled-all-UpdatedStreams.m3u8
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./Compiled-all-Streams.m3u8
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./CompiledallStreams.m3u8
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./Compiled-all-UpdatedStreams.m3u
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./Compiled-all-Streams.m3u
          cat ./tests/m3u8/all-streams.m3u8 ./temp/m3u8_static/all/all-staticstreams.m3u8 > ./CompiledallStreams.m3u
          
      
      - name: Create Workflow Artifact #this is created, so if theres an error, you can look back at previous yml
        uses: actions/upload-artifact@v2
        with:
         name: workflow_${{ steps.date.outputs.date }}
         path: .github/workflows/m3u8_converter.yml
       
       
                           
      - name: Push all changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.scrapper_token }}
          branch: ${{ github.ref }} 
          
      - name: Commit All Files
        uses: zwaldowski/git-commit-action@v1
        with:
             commit_message: Updated by Bot - ${{ steps.date.outputs.date }}
             working_directory: .

      - name: Push Final Changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.scrapper_token }}
          branch: ${{ github.ref }}
          
